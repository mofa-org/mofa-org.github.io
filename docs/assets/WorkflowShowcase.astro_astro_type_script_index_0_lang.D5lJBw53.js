const g="modulepreload",b=function(e){return"/"+e},h={},p=function(n,t,d){let o=Promise.resolve();if(t&&t.length>0){let i=function(c){return Promise.all(c.map(r=>Promise.resolve(r).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),f=l?.nonce||l?.getAttribute("nonce");o=i(t.map(c=>{if(c=b(c),c in h)return;h[c]=!0;const r=c.endsWith(".css"),y=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${y}`))return;const m=document.createElement("link");if(m.rel=r?"stylesheet":g,r||(m.as="script"),m.crossOrigin="",m.href=c,f&&m.setAttribute("nonce",f),document.head.appendChild(m),r)return new Promise((s,u)=>{m.addEventListener("load",s),m.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return n().catch(a)})};p(()=>import("https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs"),[]).then(e=>{e.default.initialize({startOnLoad:!0,theme:"base",themeVariables:{primaryColor:"#6366F1",primaryTextColor:"#1F2937",primaryBorderColor:"#6366F1",lineColor:"#0EA5E9",sectionBkgColor:"#F8FAFC",altSectionBkgColor:"#FFFFFF",gridColor:"#E5E7EB",secondaryColor:"#F59E0B",tertiaryColor:"#F59E0B"},fontFamily:"Inter, system-ui, -apple-system, sans-serif",fontSize:20,flowchart:{htmlLabels:!0,curve:"basis",useMaxWidth:!0,rankdir:"TB",padding:20},security:{level:"loose"},maxTextSize:9e4,maxEdges:500}),setTimeout(()=>{e.default.run(),setTimeout(()=>{document.querySelectorAll(".mermaid").forEach(n=>{const t=n.querySelector("svg"),d=n.closest("[data-scale]"),o=d?parseFloat(d.getAttribute("data-scale")):1;if(t){if(t.removeAttribute("height"),t.removeAttribute("width"),t.style.maxWidth="100%",t.style.maxHeight="100%",!t.getAttribute("viewBox")){const a=t.getBBox();t.setAttribute("viewBox",`0 0 ${a.width+20} ${a.height+20}`)}t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.style.width=`${o*100}%`,t.style.height=`${o*100}%`,t.style.transform="none"}}),k(),E()},500)},100)}).catch(e=>{console.error("Failed to load Mermaid:",e)});function k(){const e=document.querySelector(".workflow-scroll");if(!e)return;const n=.5;let t=null,d=!1,o=!1,a=null;Array.from(e.children).forEach(r=>{e.appendChild(r.cloneNode(!0)),e.insertBefore(r.cloneNode(!0),e.firstChild)}),requestAnimationFrame(()=>{const r=e.scrollWidth/3;e.scrollLeft=r});function l(){const r=e.scrollWidth/3;e.scrollLeft<=r*.2?e.scrollLeft+=r:e.scrollLeft>=r*1.8&&(e.scrollLeft-=r)}function f(){!d&&!o&&e&&(e.scrollLeft+=n,l()),t=requestAnimationFrame(f)}function c(){o=!0,a&&clearTimeout(a),a=setTimeout(()=>{o=!1},2e3)}["wheel","touchstart","touchmove","mousedown","mouseup"].forEach(r=>{e.addEventListener(r,c,{passive:!0})}),e.addEventListener("mouseenter",()=>{d=!0}),e.addEventListener("mouseleave",()=>{d=!1}),e.addEventListener("scroll",l),f(),window.addEventListener("beforeunload",()=>{t&&cancelAnimationFrame(t),a&&clearTimeout(a)})}function E(){document.querySelectorAll(".workflow-card").forEach(e=>{e.style.cursor="zoom-in"}),document.addEventListener("click",e=>{const n=e.target.closest(".workflow-card");if(!n)return;let t=n.querySelector(".mermaid svg")||n.querySelector(".mermaid");t&&(console.debug("[Gallery] Card clicked, opening modal"),v(t))},!0)}function v(e){if(!e)return;const n=Array.from(document.querySelectorAll('[class^="mermaid-container-"] svg, [class^="mermaid-container-"] .mermaid')).filter(Boolean);n.includes(e)||n.push(e);let t=n.findIndex(s=>s===e);t===-1&&(t=0);const d=document.querySelector(".workflow-modal");d&&d.remove();const o=document.createElement("div");o.className="workflow-modal",o.style.cssText="position:fixed;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);padding:2rem;",o.innerHTML=`
      <button class="gallery-nav gallery-prev" aria-label="Prev">&#9664;</button>
      <button class="gallery-nav gallery-next" aria-label="Next">&#9654;</button>
      <div class="workflow-modal-content" style="position:relative;width:90vw;height:90vh;overflow:hidden;background:#FFF3D9;border-radius:8px;border:4px solid var(--mondrian-black);box-shadow:6px 6px 0 var(--mondrian-black);display:flex;flex-direction:column;">
        <button class="workflow-modal-close" aria-label="Close" style="position:absolute;top:0.25rem;right:0.5rem;font-size:1.5rem;background:transparent;border:none;color:#333;cursor:pointer;">&times;</button>
        <div class="workflow-modal-body" style="padding:1rem;display:flex;align-items:center;justify-content:center;flex:1;overflow:auto;"></div>
        <div class="gallery-zoom" style="position:absolute;bottom:0.5rem;right:0.75rem;display:flex;gap:0.5rem;">
          <button class="zoom-in" aria-label="Zoom in" style="font-size:1.25rem;width:2rem;height:2rem;border:none;border-radius:4px;background:#e5e7eb;cursor:pointer;">+</button>
          <button class="zoom-out" aria-label="Zoom out" style="font-size:1.25rem;width:2rem;height:2rem;border:none;border-radius:4px;background:#e5e7eb;cursor:pointer;">&minus;</button>
        </div>
      </div>`,document.body.appendChild(o);const a=o.querySelector(".workflow-modal-body");let i=1;function l(){a.innerHTML="";const s=n[t];if(!s)return;let u=s.cloneNode(!0);u.tagName.toLowerCase()==="svg"&&(u.removeAttribute("width"),u.removeAttribute("height"),u.style.width="100%",u.style.height="auto",u.style.maxWidth="100%",u.style.maxHeight="100%"),u.style.transformOrigin="center center",u.style.transform=`scale(${i})`,a.appendChild(u)}function f(s){t=(t+s+n.length)%n.length,i=1,l()}l(),o.querySelector(".gallery-prev").addEventListener("click",()=>f(-1)),o.querySelector(".gallery-next").addEventListener("click",()=>f(1)),o.querySelector(".zoom-in").addEventListener("click",()=>{i=Math.min(i+.2,4),l()}),o.querySelector(".zoom-out").addEventListener("click",()=>{i=Math.max(i-.2,.4),l()});const c=document.body.style.overflow;document.body.style.overflow="hidden";const r=()=>{o.remove(),document.body.style.overflow=c,document.removeEventListener("keydown",y),document.removeEventListener("keydown",m)};o.querySelector(".workflow-modal-close").addEventListener("click",r),o.addEventListener("click",s=>{s.target===o&&r()});const y=s=>{s.key==="Escape"&&r()};document.addEventListener("keydown",y);const m=s=>{s.key==="ArrowLeft"?f(-1):s.key==="ArrowRight"?f(1):s.key==="+"?(i=Math.min(i+.2,4),l()):s.key==="-"&&(i=Math.max(i-.2,.4),l())};document.addEventListener("keydown",m)}document.addEventListener("click",e=>{const n=e.target.closest(".workflow-view-btn");if(!n)return;e.stopPropagation();const t=n.getAttribute("data-target-id"),d=document.querySelector(`.mermaid-container-${t} svg`)||document.querySelector(`.mermaid-container-${t} .mermaid`);d&&(console.log("[ViewBtn] opening modal for",t),window.openWorkflowModal(d))},!0);const w=()=>document.querySelectorAll(".workflow-card").forEach(e=>e.style.cursor="zoom-in");w();new MutationObserver(w).observe(document.querySelector(".workflow-scroll"),{childList:!0});window.openWorkflowModal=v;
