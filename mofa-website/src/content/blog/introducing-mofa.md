---
title: "MoFA æŠ€æœ¯æ¶æ„ä»‹ç»ï¼šåŸºäº Dora-RS çš„æ¨¡å—åŒ– AI æ™ºèƒ½ä½“æ¡†æ¶"
description: "ä»‹ç» MoFA çš„æŠ€æœ¯æ¶æ„ï¼Œæ¢è®¨å…¶å¦‚ä½•åŸºäº Dora-RS æ¡†æ¶æ„å»ºæ¨¡å—åŒ–ã€å¯ç»„åˆçš„ AI æ™ºèƒ½ä½“ç³»ç»Ÿ"
date: 2025-06-09
author: MoFA Team
tags: [æ¶æ„, AIæ¡†æ¶, Dora-RS, æ™ºèƒ½ä½“, æŠ€æœ¯]
---


MoFAï¼ˆ**M**odular **F**ramework for **A**gentï¼‰æ˜¯ä¸€ä¸ªåŸºäº Dora-RS æ•°æ®æµå¼•æ“æ„å»ºçš„æ™ºèƒ½ä½“å¼€å‘æ¡†æ¶ã€‚æœ¬æ–‡ä»‹ç» MoFA çš„æŠ€æœ¯æ¶æ„å’Œè®¾è®¡æ€è·¯ã€‚

## ğŸ—ï¸ æ•´ä½“æ¶æ„è®¾è®¡

<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 6160.376953125 539" style="max-width: 100%; height: auto;" xmlns="http://www.w3.org/2000/svg" width="100%"><style>#mermaid-svg-inline{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:rgba(204, 204, 204, 0.87);}#mermaid-svg-inline .error-icon{fill:#bf616a;}#mermaid-svg-inline .error-text{fill:#bf616a;stroke:#bf616a;}#mermaid-svg-inline .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-inline .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-inline .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-inline .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-inline .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-inline .marker{fill:rgba(204, 204, 204, 0.87);stroke:rgba(204, 204, 204, 0.87);}#mermaid-svg-inline .marker.cross{stroke:rgba(204, 204, 204, 0.87);}#mermaid-svg-inline svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-inline .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:rgba(204, 204, 204, 0.87);}#mermaid-svg-inline .cluster-label text{fill:#ffffff;}#mermaid-svg-inline .cluster-label span,#mermaid-svg-inline p{color:#ffffff;}#mermaid-svg-inline .label text,#mermaid-svg-inline span,#mermaid-svg-inline p{fill:rgba(204, 204, 204, 0.87);color:rgba(204, 204, 204, 0.87);}#mermaid-svg-inline .node rect,#mermaid-svg-inline .node circle,#mermaid-svg-inline .node ellipse,#mermaid-svg-inline .node polygon,#mermaid-svg-inline .node path{fill:#1a1a1a;stroke:#2a2a2a;stroke-width:1px;}#mermaid-svg-inline .flowchart-label text{text-anchor:middle;}#mermaid-svg-inline .node .label{text-align:center;}#mermaid-svg-inline .node.clickable{cursor:pointer;}#mermaid-svg-inline .arrowheadPath{fill:#e5e5e5;}#mermaid-svg-inline .edgePath .path{stroke:rgba(204, 204, 204, 0.87);stroke-width:2.0px;}#mermaid-svg-inline .flowchart-link{stroke:rgba(204, 204, 204, 0.87);fill:none;}#mermaid-svg-inline .edgeLabel{background-color:#1a1a1a99;text-align:center;}#mermaid-svg-inline .edgeLabel rect{opacity:0.5;background-color:#1a1a1a99;fill:#1a1a1a99;}#mermaid-svg-inline .labelBkg{background-color:rgba(26, 26, 26, 0.5);}#mermaid-svg-inline .cluster rect{fill:rgba(64, 64, 64, 0.47);stroke:#30373a;stroke-width:1px;}#mermaid-svg-inline .cluster text{fill:#ffffff;}#mermaid-svg-inline .cluster span,#mermaid-svg-inline p{color:#ffffff;}#mermaid-svg-inline div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:#88c0d0;border:1px solid #30373a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-inline .flowchartTitleText{text-anchor:middle;font-size:18px;fill:rgba(204, 204, 204, 0.87);}#mermaid-svg-inline :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g id="mermaid-svg-inline"><g><g class="clusters"><g class="cluster default flowchart-label"><rect height="312.5" width="3988.619140625" y="0" x="0" ry="0" rx="0" style=""/><g transform="translate(1958.3017578125, 0)" class="cluster-label"><text class="nodeLabel">MoFA æ¶æ„</text></g></g><g class="cluster default flowchart-label"><rect height="396" width="2135.7578125" y="127" x="4008.619140625" ry="0" rx="0" style=""/><g transform="translate(5030.134765625, 127)" class="cluster-label"><text class="nodeLabel">Dora-RS æ¶æ„</text></g></g></g><g class="edgePaths"><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M349.477,58.5L349.477,146.7"/><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M263.615,185.5L129.507,250.821"/><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M385.081,185.5L457.883,248.7"/><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M440.34,179.14L795.48,248.7"/><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M440.34,174.572L1145.449,248.7"/><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M3837.61,58.5L4102.636,156.775"/><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M4175.287,185.5L4175.287,248.7"/><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M4175.287,287.5L4175.287,375.7"/><path style="fill:none;stroke:rgba(204, 204, 204, 0.87);stroke-width:2px" d="M4175.287,414.5L4175.287,459.2"/></g><g class="nodes"><g transform="translate(349.4765625, 41.75)" class="node default"><rect height="33.5" width="137.1015625" y="-16.75" x="-68.55078125" ry="0" rx="0" style="fill:#f3e5f5;" class="basic label-container"/><text class="nodeLabel">CLI - mofa/cli.py</text></g><g transform="translate(349.4765625, 168.75)" class="node default"><rect height="33.5" width="181.7265625" y="-16.75" x="-90.86328125" ry="0" rx="0" style="" class="basic label-container"/><text class="nodeLabel">Agent Build Framework</text></g><g transform="translate(156.09765625, 270.75)" class="node default"><rect height="33.5" width="242.1953125" y="-16.75" x="-121.09765625" ry="0" rx="0" style="fill:#f3e5f5;" class="basic label-container"/><text class="nodeLabel">Base Agent - agent_build/base/</text></g><g transform="translate(457.8828125, 270.75)" class="node default"><rect height="33.5" width="261.375" y="-16.75" x="-130.6875" ry="0" rx="0" style="" class="basic label-container"/><text class="nodeLabel">ReasonER - agent_build/reasoner/</text></g><g transform="translate(795.48046875, 270.75)" class="node default"><rect height="33.5" width="313.8203125" y="-16.75" x="-156.91015625" ry="0" rx="0" style="" class="basic label-container"/><text class="nodeLabel">CrewAI Integration - agent_build/crewai/</text></g><g transform="translate(1145.44921875, 270.75)" class="node default"><rect height="33.5" width="286.1171875" y="-16.75" x="-143.05859375" ry="0" rx="0" style="" class="basic label-container"/><text class="nodeLabel">Self Refine - agent_build/self_refine/</text></g><g transform="translate(4175.287109375, 168.75)" class="node default"><rect height="33.5" width="134.84375" y="-16.75" x="-67.421875" ry="0" rx="0" style="fill:#e1f5fe;" class="basic label-container"/><text class="nodeLabel">CLI - binaries/cli</text></g><g transform="translate(4175.287109375, 270.75)" class="node default"><rect height="33.5" width="263.3359375" y="-16.75" x="-131.66796875" ry="0" rx="0" style="fill:#e1f5fe;" class="basic label-container"/><text class="nodeLabel">Coordinator - binaries/coordinator</text></g><g transform="translate(4175.287109375, 397.75)" class="node default"><rect height="33.5" width="209.7265625" y="-16.75" x="-104.86328125" ry="0" rx="0" style="fill:#e1f5fe;" class="basic label-container"/><text class="nodeLabel">Daemon - binaries/daemon</text></g><g transform="translate(4175.287109375, 481.25)" class="node default"><rect height="33.5" width="211.3828125" y="-16.75" x="-105.69140625" ry="0" rx="0" style="fill:#e1f5fe;" class="basic label-container"/><text class="nodeLabel">Runtime - binaries/runtime</text></g></g></g></svg>

MoFA ä¸ Dora-RS å½¢æˆåˆ†å±‚æ¶æ„ï¼Œæ„æˆä»åº•å±‚é€šä¿¡åˆ°ä¸Šå±‚æ™ºèƒ½ä½“çš„æŠ€æœ¯æ ˆï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MoFA å±‚                   â”‚  â† AIæ™ºèƒ½ä½“å¼€å‘æ¡†æ¶
â”‚  æ™ºèƒ½ä½“æ¨¡æ¿ + ç»„åˆé€»è¾‘ + æ ¸å¿ƒæœåŠ¡    â”‚     (Pythonä¸ºä¸»)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Dora å±‚                   â”‚  â† æ•°æ®æµå¼•æ“  
â”‚  å®æ—¶é€šä¿¡ + è·¨è¯­è¨€ + è¿è¡Œæ—¶ç®¡ç†     â”‚     (Rustæ ¸å¿ƒ)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ MoFA æ ¸å¿ƒç»„ä»¶

### 1. æ™ºèƒ½ä½“æ„å»ºæ¡†æ¶ (Agent Build Framework)

æä¾›æ™ºèƒ½ä½“å¼€å‘çš„åŸºç¡€æŠ½è±¡å’Œå¸¸è§æ¨¡å¼ï¼š

#### **åŸºç¡€æ™ºèƒ½ä½“ (Base Agent)**
```python
from mofa.agent_build.base.base_agent import MofaAgent
from dora import Node

class MofaAgent:
    def __attrs_post_init__(self):
        self.node = Node(self.agent_name)  # é›†æˆ Dora èŠ‚ç‚¹
        
    def receive_parameter(self, parameter_name: str):
        for event in self.node:  # ä½¿ç”¨ Dora äº‹ä»¶å¾ªç¯
            # æ™ºèƒ½ä½“ä¸šåŠ¡é€»è¾‘
            
    def send_output(self, output_name: str, result: Any):
        self.node.send_output(output_name, ...)  # é€šè¿‡ Dora å‘é€
```

#### **æ™ºèƒ½ä½“æ¨¡å¼**
- **ReasonER**: æ”¯æŒæ¨ç†é“¾çš„æ™ºèƒ½ä½“
- **CrewAI Integration**: é›†æˆ CrewAI çš„å¤šæ™ºèƒ½ä½“åä½œ
- **Self Refine**: æ”¯æŒè¾“å‡ºè‡ªæˆ‘æ”¹è¿›çš„æ™ºèƒ½ä½“

### 2. æ ¸å¿ƒæœåŠ¡ (Kernel Services)

æä¾›æ™ºèƒ½ä½“ç³»ç»Ÿçš„åŸºç¡€æœåŠ¡ï¼š

- **Memory**: æ™ºèƒ½ä½“è®°å¿†ç®¡ç†
- **Planning**: ä»»åŠ¡è§„åˆ’å’Œè°ƒåº¦
- **RAG**: æ£€ç´¢å¢å¼ºç”Ÿæˆ
- **Tools**: å·¥å…·è°ƒç”¨å’Œç®¡ç†

### 3. æ™ºèƒ½ä½“æ¨¡æ¿ (Agent Templates)

é¢„æ„å»ºçš„æ™ºèƒ½ä½“é…ç½®ï¼Œç®€åŒ–å¼€å‘æµç¨‹ï¼š

```yaml
# æ™ºèƒ½ä½“é…ç½®ç¤ºä¾‹
nodes:
  - id: reasoning-agent
    build: pip install -e ../../agent-hub/openai-agent
    path: openai-agent
    inputs:
      query: terminal-input/data
    outputs:
      - reasoning_result
```

### 4. ç”Ÿæ€ç³»ç»Ÿ

#### **Node Hub**: æ‰©å±• Dora ç”Ÿæ€
- `terminal-input` / `terminal-print`: ç»ˆç«¯ I/O èŠ‚ç‚¹
- `dora-openai-server`: OpenAI API æœåŠ¡é›†æˆ
- `openai-server-stream`: æµå¼ AI æœåŠ¡

#### **Agent Hub**: é¢„æ„å»ºæ™ºèƒ½ä½“åº“
- `hello-world`: åŸºç¡€ç¤ºä¾‹æ™ºèƒ½ä½“
- `openai-agent`: OpenAI é›†æˆæ™ºèƒ½ä½“
- `memory-agent`: å¸¦è®°å¿†çš„æ™ºèƒ½ä½“
- `kling-agent`: è§†é¢‘ç”Ÿæˆæ™ºèƒ½ä½“
- æ›´å¤šä¸“ç”¨æ™ºèƒ½ä½“...

## âš¡ Dora-RS åŸºç¡€è®¾æ–½

### æ¶æ„ç»„æˆ

Dora-RS ä¸º MoFA æä¾›è¿è¡Œæ—¶åŸºç¡€ï¼š

```
dora/
â”œâ”€â”€ binaries/              # è¿è¡Œæ—¶ç»„ä»¶
â”‚   â”œâ”€â”€ cli/              # dora å‘½ä»¤è¡Œå·¥å…·
â”‚   â”œâ”€â”€ coordinator/      # åˆ†å¸ƒå¼åè°ƒå™¨
â”‚   â”œâ”€â”€ daemon/           # åå°å®ˆæŠ¤è¿›ç¨‹
â”‚   â””â”€â”€ runtime/          # æ•°æ®æµè¿è¡Œæ—¶
â”œâ”€â”€ libraries/             # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ core/            # è°ƒåº¦å¼•æ“
â”‚   â”œâ”€â”€ communication-layer/ # é€šä¿¡å±‚
â”‚   â”œâ”€â”€ shared-memory-server/ # å…±äº«å†…å­˜æœåŠ¡
â”‚   â””â”€â”€ message/         # åŸºäº Apache Arrow çš„æ¶ˆæ¯ç³»ç»Ÿ
â”œâ”€â”€ apis/                 # å¤šè¯­è¨€ API
â”‚   â”œâ”€â”€ rust/ python/ c/ c++/  # è·¨è¯­è¨€æ”¯æŒ
â””â”€â”€ node-hub/            # é¢„æ„å»ºèŠ‚ç‚¹
    â”œâ”€â”€ dora-yolo/       # YOLO ç›®æ ‡æ£€æµ‹
    â”œâ”€â”€ dora-sam2/       # SAM2 åˆ†å‰²
    â”œâ”€â”€ dora-qwen/       # Qwen å¤§è¯­è¨€æ¨¡å‹
    â””â”€â”€ ...              # æ›´å¤š AI/ç¡¬ä»¶èŠ‚ç‚¹
```

### æŠ€æœ¯ç‰¹ç‚¹

1. **æ€§èƒ½**: åŸºäº Rust å’Œå…±äº«å†…å­˜çš„é«˜æ•ˆé€šä¿¡
2. **é›¶æ‹·è´**: åŸºäº Apache Arrow çš„æ•°æ®ä¼ è¾“
3. **è·¨è¯­è¨€**: Python æ™ºèƒ½ä½“å¯ä¸å…¶ä»–è¯­è¨€èŠ‚ç‚¹åä½œ
4. **å®æ—¶æ€§**: ä½å»¶è¿Ÿçš„èŠ‚ç‚¹é—´é€šä¿¡

## ğŸ”„ æ•°æ®æµè®¾è®¡

### æ•°æ®æµ vs å·¥ä½œæµ

MoFA é‡‡ç”¨æ•°æ®æµé©±åŠ¨çš„è®¾è®¡ï¼š

```
ä¼ ç»Ÿå·¥ä½œæµ:
Task â†’ Rule â†’ Step â†’ Rule â†’ Step â†’ Result

æ•°æ®æµæ–¹å¼:
Data â†’ Node â†’ Data â†’ Node â†’ Data â†’ Result
  â†‘      â†‘      â†‘      â†‘      â†‘
  |   æ™ºèƒ½ä½“   |   æ™ºèƒ½ä½“   |
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€é€šä¿¡å±‚â”€â”€â”€â”€â”€â”€â”˜
```

### é…ç½®é©±åŠ¨

é€šè¿‡ YAML é…ç½®å®ç°æ™ºèƒ½ä½“ç»„åˆï¼š

```yaml
# hello_world_dataflow.yml
nodes:
  - id: terminal-input
    build: pip install -e ../../node-hub/terminal-input
    path: dynamic
    outputs: [data]
    inputs:
      agent_response: hello-world-agent/hello_world_result
      
  - id: hello-world-agent
    build: pip install -e ../../agent-hub/hello-world
    path: hello-world
    outputs: [hello_world_result]
    inputs:
      query: terminal-input/data
    env:
      IS_DATAFLOW_END: true
      WRITE_LOG: true
```

## ğŸ”— å…³é”®é›†æˆ

### 1. æ™ºèƒ½ä½“ä¸ Dora çš„é›†æˆ

```python
# MoFA æ™ºèƒ½ä½“ä½¿ç”¨ Dora Node
from dora import Node

class MofaAgent:
    def __attrs_post_init__(self):
        self.node = Node(self.agent_name)
```

### 2. ç”Ÿæ€ç³»ç»Ÿæ‰©å±•

| ç»„ä»¶ç±»å‹ | DoraåŸç”Ÿ | MoFAæ‰©å±• |
|----------|----------|----------|
| MoFAä¸“ç”¨ | - | `dora-openai-server`, `openai-server-stream` |
| æ™ºèƒ½ä½“ | - | `agent-hub/*` |

### 3. æ•°æ®æµè¿æ¥

é€šè¿‡ Dora çš„æ•°æ®æµæœºåˆ¶å®ç°ï¼š
- æ™ºèƒ½ä½“ä¸ç¡¬ä»¶è®¾å¤‡é€šä¿¡
- æ™ºèƒ½ä½“ä¸ AI æ¨¡å‹äº¤äº’
- æ™ºèƒ½ä½“æ•°æ®æµæ„å»º

## ğŸ¯ ç»„åˆå¼æ™ºèƒ½ä½“

### ç»„åˆå±‚æ¬¡

```
å¤åˆæ™ºèƒ½ä½“
    â†“
åŸºç¡€æ™ºèƒ½ä½“ç»„åˆ
    â†“
MofaAgent
    â†“
Dora Node
```

### åº”ç”¨ç¤ºä¾‹

```python
# åŸºç¡€æ™ºèƒ½ä½“
@run_agent
def run(agent: MofaAgent):
    user_query = agent.receive_parameter('query')
    # å¤„ç†é€»è¾‘
    agent.send_output('result', processed_data)

# é€šè¿‡é…ç½®ç»„åˆï¼šinput â†’ reasoning_agent â†’ memory_agent â†’ output
```

## ğŸš€ æŠ€æœ¯ä¼˜åŠ¿

### 1. æ€§èƒ½
- **Rust å†…æ ¸**: å†…å­˜å®‰å…¨å’Œæ€§èƒ½
- **å…±äº«å†…å­˜**: å‡å°‘æ•°æ®æ‹·è´
- **Apache Arrow**: é«˜æ•ˆçš„åˆ—å¼æ•°æ®æ ¼å¼

### 2. å¼€å‘ä½“éªŒ
- **é…ç½®åŒ–**: YAML é…ç½®å®Œæˆç»„åˆ
- **æ¨¡æ¿åŒ–**: é¢„æ„å»ºçš„æ™ºèƒ½ä½“å’Œæ¨¡å¼
- **è·¨è¯­è¨€**: ç»Ÿä¸€çš„å¼€å‘æ¥å£

### 3. æ‰©å±•æ€§
- **åˆ†å¸ƒå¼**: æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²
- **æ¨¡å—åŒ–**: æ¾è€¦åˆçš„ç»„ä»¶è®¾è®¡
- **ç”Ÿæ€**: ä¸°å¯Œçš„èŠ‚ç‚¹å’Œæ™ºèƒ½ä½“åº“




---
